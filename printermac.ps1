# Define the list of IP addresses
$ipAddresses = @("172.22.106.45","172.22.106.45","172.22.106.45","172.22.106.250","172.22.106.250","172.22.106.252","172.22.106.252","172.22.106.253","172.22.106.253","172.22.106.242","172.22.106.242","172.22.106.241","172.22.106.241","172.22.106.244","172.22.106.244","172.22.106.213","172.22.106.213","172.22.106.217","172.22.106.217","172.22.106.205","172.22.106.205","172.22.106.214","172.22.106.214","172.22.106.216","172.22.106.216","172.22.106.229","172.22.106.229","172.22.106.206","172.22.106.206","172.22.106.207","172.22.106.207","172.22.106.208","172.22.106.208","172.22.106.210","172.22.106.210","172.22.106.238","172.22.106.238","172.22.106.215","172.22.106.215","172.22.106.218","172.22.106.218","172.22.106.209","172.22.106.209","172.22.106.222","172.22.106.222","172.22.106.221","172.22.106.221","172.22.106.226","172.22.106.226","172.22.106.227","172.22.106.227","172.22.106.231","172.22.106.231","172.22.106.232","172.22.106.232","172.22.106.236","172.22.106.236","172.22.106.245","172.22.106.245","172.22.106.211","172.22.106.211","172.22.106.248","172.22.106.248","172.22.106.254","172.22.106.254","172.22.106.201","172.22.106.201","172.22.106.202","172.22.106.202","172.27.12.211","172.27.12.203","172.27.12.201","172.27.10.206","172.27.10.205","172.27.10.204","172.27.10.203","172.27.10.202","172.27.10.5","172.27.10.201","172.27.114.228","172.27.114.227","172.27.114.226","172.27.114.225","172.27.114.224","172.27.114.223","172.27.114.222","172.27.106.9","172.27.122.229","172.27.122.232","172.27.122.227","172.27.122.230","172.27.122.222","172.27.122.228","172.27.122.221","172.27.122.220","172.27.122.231","172.27.122.226","172.27.122.223","172.27.122.235","172.27.122.224","172.27.74.205","172.27.74.204","172.27.74.203","172.27.74.202","172.27.74.201","172.27.74.200","172.27.74.210","172.27.90.6","172.27.90.5","172.27.98.18","172.27.98.6","172.27.34.208","172.27.34.207","172.27.34.206","172.27.34.205","172.27.194.202","172.27.194.201","172.27.194.212","172.27.194.203","172.27.194.200","KAN-5TH-PRN-05-BW","172.27.42.214","172.27.42.213","172.27.42.212","172.27.42.211","172.27.42.205","172.27.42.204","172.27.42.201","172.27.130.243","172.27.130.242","172.27.130.241","172.27.130.240","172.22.181.201","172.22.181.206","172.22.181.205","172.22.181.209","172.22.181.203","172.22.178.217","172.22.178.215","172.22.178.214","172.22.178.211","172.22.178.207","172.22.178.208","172.22.178.206","172.22.178.205","172.22.178.203","172.22.178.202","172.22.178.201","172.22.178.223","172.22.178.220","172.22.178.219","172.22.178.213","172.22.178.204","172.22.178.210"
)

# Initialize an array to store results
$results = @()

# Loop through each IP address
foreach ($ipAddress in $ipAddresses) {
    # Execute arp command to get MAC address
    $arpResult = arp -a | Where-Object { $_ -match $ipAddress }

    # Extract MAC address from the result
    if ($arpResult) {
        $macAddress = ($arpResult -split '\s+')[1]
        $result = [PSCustomObject]@{
            "IPAddress" = $ipAddress
            "MACAddress" = $macAddress
        }
        $results += $result
    } else {
        $result = [PSCustomObject]@{
            "IPAddress" = $ipAddress
            "MACAddress" = "Not Found"
        }
        $results += $result
    }
}

# Output results to CSV file
$results | Export-Csv -Path "C:\temp\IP_MacAddress.csv" -NoTypeInformation

Write-Output "Results exported to C:\temp\IP_MacAddress.csv"
