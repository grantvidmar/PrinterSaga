# PrinterSaga
This is a code set that I made to discover network printers and reprogram the DNS.

This was a mess of a project that I built over the course of a week, mostly out of my ignorance. I was given a project to change the DNS of all of out networked printers. We had no list of all of our printers, so the first goal was to locate all of the printer and get the printer name and ip address of them all. We had a general list of all of our print servers but no list of all of the printers on them. The print servers also still had dnagling printers from before 2020 and had more physical printers. My intital script to find printers was set to look at the network shares for our print server and report all of the printers that are saved to the print server. This gave me names and ip adresses, If I was smarter I would have added a ping in this section to check and see if they are live and give it a status on the resulting spreadsheet. I my add this in at a later date to improve the code. 

With out knowing the status of the printers this required me to access each individual printers web portal. Which was a good but tedious thing as I needed to test our admin creds for each printer as well. We had a mixed bag of printer brands with the primary being Ricoh, Cannon, Konico Minolta, and finally HP. Luckily we had some standardization in the admin creds per brand. Armed with that information I was able to build the next set of scripts. 

For the next script I deviated from my comfort zone of powershell after spending a frustrating amount of time trying to get it to work. The bulk of the printers that I needed to reprogram are Ricoh printers, something about their configuration makes them not play well with scripting to an extent. I believe it comes from having "splash" text after the initial telnet connection. 
So everytime I tried to write code that would wait and read text replies from the printer it would get hung up. You will see that in some of the early version of this code. I tried so many ways to get this to connect. I tried using pythons telnetlib and telnetlib3 in combination with timed commands. I tried writing bat files to do the work. I tried Bash scripts to get it to work. But they all met the same hurdle of not being able to get passed what ever "splash" text Ricoh sends after connecting to the printer via telnet (yeah I know telnet, ugh).

So then I went back and just made it as simple as I could, use python autogui and timed inputs to just do the work. I setup a csv to hold all the ip addresses for the Ricoh printers and used command line plink to connect to them all. After that it was all about reading the documention of the Ricoh printers to find out the commands I needed to exicute the changes. These happen to be specific to Ricoh so I have depricated the project to have the script with the commands for those printers. In future I plan to have different versions of this script for all the printer types we have in our estate. Currently only the Ricoh one is written. 

I have attempted to start writing the HP version fo this script but our HP printers are being really annoying and are not letting telnet or ssh connections and I cannot figure out why.
